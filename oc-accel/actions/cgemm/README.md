# orthogonal Systolic Array based HW for batched GEMMs

This design uses any arithmetic as long as there is a [de]norm unit for S3
keywords: flopoco, SNAP, oc-accel, long and exact kulisch accumulators, Systolic Array, blocked GEMM, batched GEMM, blas,OpenBLAS.

## Hardware

The hardware part implements the following core functions:
 * N*M orthogonal Systolic Array with local control
 * Maximum reuse of the Data
 * SA of PE composed of S3FDP generated by flopoco for the VU9P for a frequency for a parametric arithmetic

The hw folder contains a lib folder which contains systolic array folder with the custom flopoco binary to generate offline the good Systolic Array
The hw folder additionally contains helpers such as hand-made fifos to handle outter communications bursts.

## Software

The software stack is based on a modified OpenBLAS which calls our underneath hardware built purposedly for power9 and oc-accel. Although it is specific for this platform and link all code remains general purpose and is easily adaptable to other platforms.

A BLAS call basically performs:
  * allocates MAT A in, MAT B in, and MAT C out in aligned fasion for efficient transfers (DMAs)
  * send pointers of in and out
  * send start to HW
  * synchronally pull done register in FPGA or wait for timeout
  * print or write to file classifications
